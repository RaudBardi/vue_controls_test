(function(t){function e(e){for(var r,u,c=e[0],s=e[1],a=e[2],f=0,p=[];f<c.length;f++)u=c[f],o[u]&&p.push(o[u][0]),o[u]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r]);l&&l(e);while(p.length)p.shift()();return i.push.apply(i,a||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,c=1;c<n.length;c++){var s=n[c];0!==o[s]&&(r=!1)}r&&(i.splice(e--,1),t=u(u.s=n[0]))}return t}var r={},o={app:0},i=[];function u(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.m=t,u.c=r,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)u.d(n,r,function(e){return t[e]}.bind(null,r));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=e,c=c.slice();for(var a=0;a<c.length;a++)e(c[a]);var l=s;i.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},1313:function(t,e,n){"use strict";var r=n("5c06"),o=n.n(r);o.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("ControlStage")],1)},i=[],u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"control-stage"},[n("h3",[t._v("Три взаимодействующих контролла")]),n("form",[t._l(t.controls,function(e,r){return n("fieldset",{key:e.id},[n("label",[t._v(t._s(e.name))]),n("Control",{ref:"control_"+e.id,refInFor:!0,attrs:{id:e.id,type:e.type,tabindex:r+1,helper:e.helperName},on:{helperHandler:function(n){return t.handle_func_call(e.helperMethod,r)},focus:function(n){return t.focus(e.id,n)},change:function(n){return t.getChange(e.value,r)},input:function(n){return t.getChange(e.value,r)},keyupEnter:function(n){return t.keyupEnter(e.value,r,n)},keyupEsc:function(e){return t.keyupEsc(r,e)},keyupTab:function(e){return t.keyupTab(r,e)},click:function(n){return t.onClick(e.id,n)}},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"control.value"}})],1)}),n("fieldset",[n("button",{on:{click:function(e){return e.preventDefault(),t.clearData(e)}}},[t._v("___ RESET ___")])])],2)])},c=[],s=n("75fc"),a=(n("6b54"),n("a481"),n("7f7f"),n("c5f6"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"control-wrap",class:{inFocus:t.inFocus},on:{click:function(e){return t.$emit("click",e)}}},[n("input",{ref:"input"+t.id,staticClass:"input",attrs:{disabled:!t.inFocus,type:t.type,tabIndex:t.tabindex},domProps:{value:t.value},on:{input:function(e){return t.$emit("input",e.target.value)},change:function(e){return t.$emit("change",e.target.value)},focus:function(e){return t.$emit("focus",e)},keydown:[function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:(e.preventDefault(),t.$emit("keyupEnter",e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"esc",27,e.key,["Esc","Escape"])?null:(e.preventDefault(),t.$emit("keyupEsc",e))},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"tab",9,e.key,"Tab")?null:(e.preventDefault(),t.$emit("keyupTab",e))}]}}),n("span",{staticClass:"value"},[t._v(t._s(t._f("splitNumber")(t.value)))]),n("span",{staticClass:"arrow"}),t.helper?n("span",{staticClass:"helper",on:{click:function(e){return t.$emit("helperHandler")}}},[t._v(t._s(t.helper))]):t._e()])}),l=[],f={name:"Control",data:function(){return{inFocus:!1}},props:{type:String,helper:String,id:Number|String,value:Number|String,tabindex:Number|String},filters:{splitNumber:function(t){return t.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}}},p=f,d=(n("1313"),n("2877")),h=Object(d["a"])(p,a,l,!1,null,"439ae907",null),v=h.exports,g={name:"ControlStage",data:function(){return{tempVal:Number|String}},components:{Control:v},methods:{documentOnClick:function(t){var e=this;if(!t.target.classList.contains("input")&&!t.target.classList.contains("arrow")&&!t.target.classList.contains("value")&&!t.target.classList.contains("helper")&&!t.target.classList.contains("control-wrap"))for(var n in this.$refs)this.$refs[n][0].inFocus&&(this.$store.dispatch("SET_CONTROL_VALUE",{index:this.$refs[n][0].tabindex-1,value:0===+this.$refs[n][0].value?0:+this.$refs[n][0].value.toString().replace(/^0+/,"")}).catch(function(){return e.error=!0}),this.$refs[n][0].inFocus=!1)},onClick:function(t,e){var n=this;if(!this.$refs["control_"+t][0].inFocus){for(var r in this.$refs)this.$refs[r][0].inFocus=!1;this.$nextTick(function(){n.$refs["control_"+t][0].inFocus=!0,n.$nextTick(function(){return n.$refs["control_"+t][0].$refs["input"+t].focus()})})}},keyupEsc:function(t,e){var n=this;this.$store.dispatch("SET_CONTROL_VALUE",{index:t,value:+this.tempVal.toString().replace(/^0+/,"")}).catch(function(){return n.error=!0}),e.target.blur(),this.$nextTick(function(){for(var t in n.$refs)n.$refs[t][0].inFocus=!1})},keyupEnter:function(t,e,n){var r=this;n.target.blur(),this.$store.dispatch("SET_CONTROL_VALUE",{index:e,value:0===+t?0:+t.toString().replace(/^0+/,"")}).catch(function(){return r.error=!0}),this.$nextTick(function(){for(var t in r.$refs)r.$refs[t][0].inFocus=!1})},keyupTab:function(t,e){var n=this;for(var r in this.$refs)this.$refs[r][0].inFocus=!1;var o=e.shiftKey?this.$store.getters.getControlByIndex(+t-1)?this.$store.getters.getControlByIndex(+t-1).id:this.$store.getters.getControlByIndex(this.controls.length-1).id:this.$store.getters.getControlByIndex(+t+1)?this.$store.getters.getControlByIndex(+t+1).id:this.$store.getters.getControlByIndex(0).id;this.$nextTick(function(){n.$refs["control_"+o][0].inFocus=!0,n.$nextTick(function(){return n.$refs["control_"+o][0].$refs["input"+o].focus()})})},getChange:function(t,e){var n=this;1!==e&&2!==e||this.$store.dispatch("SET_CONTROL_VALUE",{index:1===+e?2:1,value:0===+t?0:+t.toString().replace(/^0+/,"")}).catch(function(){return n.error=!0})},focus:function(t,e){this.tempVal=this.$store.getters.getControlById(+t).value,e.target.select()},getSum:function(){var t=this;this.$store.dispatch("GET_SUM",[0,1,2]).catch(function(){return t.error=!0})},setConst:function(t){var e=this;this.$store.dispatch("SET_CONTROL_VALUE",{index:+t,value:1e3}).catch(function(){return e.error=!0}),this.$nextTick(function(){return e.getChange(1e3,t)})},clearData:function(){var t=this;this.$store.dispatch("RESET_STATE").catch(function(){return t.error=!0})},handle_func_call:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];this[e[0]].apply(this,Object(s["a"])(e.slice(1)))}},computed:{controls:function(){return this.$store.state.controls}},mounted:function(){document.addEventListener("click",this.documentOnClick)},beforeDestroy:function(){document.removeEventListener("click",this.documentOnClick)}},m=g,y=(n("bf2f"),Object(d["a"])(m,u,c,!1,null,"1a589ca5",null)),_=y.exports,b={name:"app",components:{ControlStage:_}},$=b,k=(n("7faf"),Object(d["a"])($,o,i,!1,null,null,null)),C=k.exports,S=(n("7514"),n("2f62"));r["a"].use(S["a"]);var E=function(){return{controls:[{id:1,name:"Контролл 1",type:"number",value:0,helperName:"Сумма",helperMethod:"getSum"},{id:2,name:"Контролл 2",type:"number",value:0,helperName:"Константа",helperMethod:"setConst"},{id:3,name:"Контролл 3",type:"number",value:0}]}},x=E(),T=new S["a"].Store({state:x,getters:{getControlById:function(t){return function(e){return t.controls.find(function(t){return t.id===e})}},getControlByIndex:function(t){return function(e){return t.controls[e]}}},actions:{RESET_STATE:function(t){t.commit("resetState")},GET_SUM:function(t,e){t.commit("getSum",e)},UPDATE_CONTROLS:function(t,e){t.commit("updateControls",e)},SET_CONTROL_VALUE:function(t,e){t.commit("setControlValue",e)}},mutations:{resetState:function(t){Object.assign(t,E())},getSum:function(t,e){t.controls[e[0]].value=+t.controls[e[1]].value+ +t.controls[e[2]].value},updateControls:function(t,e){t.controls=e},setControlValue:function(t,e){t.controls[e.index].value=e.value}}});r["a"].config.devtools=!0,r["a"].config.productionTip=!0,new r["a"]({store:T,render:function(t){return t(C)}}).$mount("#app")},"5c06":function(t,e,n){},"5db4":function(t,e,n){},"7faf":function(t,e,n){"use strict";var r=n("8fba"),o=n.n(r);o.a},"8fba":function(t,e,n){},bf2f:function(t,e,n){"use strict";var r=n("5db4"),o=n.n(r);o.a}});
//# sourceMappingURL=app.e6ad28b3.js.map